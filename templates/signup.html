{% extends "template.html" %}
{% block title %}BoookSwap - Sign Up{% endblock %}
{% block content %}

<style>
    #overall_create_account {
        min-height: fit-content;
    }
    
    #create_account_div {
        margin-top: 5%;
        
        float: left;
        width: 49%;
        border-top-left-radius: 8px;
        border-bottom-left-radius: 8px;
        height: 300px;
        min-height: fit-content;
        
        color: #FFFFFF;
        
        background-image: url("http://eddylu.com/images/books5_flipped.jpg");
        background-size: 100%;
        
        padding-left: 20px;
    }
    
    #password_requirements {
        margin-top: 5%;
        
        float: left;
        width: 49%;
        border-top-right-radius: 8px;
        border-bottom-right-radius: 8px;
        height: 300px;
        min-height: fit-content;
        
        background-image: url("http://eddylu.com/images/books5_edited.jpg");
        background-size: 100%;
        
        font-weight: 500;
        
        padding-left: 20px;
    }
    
    #password_requirements_ul {
        margin-top: 20px;
    }
    
    #password_requirements_ul li {
        padding: 8px;
        font-weight: 500;
    }
</style>

<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>

<div id="create_account_div">
    <h1>Create Account</h1>
    <br>
    <form method="post" action="/create_account" style="width: 90%;">
        <div class="form-group">
            <label for="usr">Email:</label>
            <input type="email" class="form-control" name="email" id="usr" autofocus="true"
                   onkeypress="update_password_requirements()" autocomplete="off" autofocus="true"
                   onkeyup="if (!(event.keyCode == 37 || event.keyCode == 38 || event.keyCode == 39 || event.keyCode == 40)) update_password_requirements();">
        </div>
        <div class="form-group">
            <label for="pwd">Password:</label>
            <input type="password" class="form-control" name="password" id="pwd"
                   onkeypress="update_password_requirements()" autocomplete="off" autofocus="true"
                   onkeyup="if (!(event.keyCode == 37 || event.keyCode == 38 || event.keyCode == 39 || event.keyCode == 40)) update_password_requirements();">
        </div>
        <button id="signup_submit" type="submit" class="btn btn-default" onclick="">Create Account</button>
    </form>
</div>

<div id="password_requirements">
    <h2 style="margin-top: 30px; margin-left: 10px;">Password Requirements</h2>
    <ul id="password_requirements_ul">
        <li id="password_requirement_1" style="font-weight: 500; font-size: initial;">Lowercase character required</li>
        <li id="password_requirement_2" style="font-weight: 500; font-size: initial;">Uppercase character required</li>
        <li id="password_requirement_3" style="font-weight: 500; font-size: initial;">Number required</li>
        <li id="password_requirement_4" style="font-weight: 500; font-size: initial;">Password must be at least 8 alphanumeric characters long</li>
        <li id="password_requirement_5" style="font-weight: 700; font-size: medium; color: green;">Password must be at most 30 alphanumeric characters long</li>
    </ul>
</div>

    <script>
        $(document).ready(function () {
            $(window).keydown(function (event) {
                var pwd = document.getElementById('pwd').value;
                var usr = document.getElementById('usr').value;
                if (event.keyCode == 13 && !((/.*[a-z]/).test(pwd) && (/.*[A-Z]/).test(pwd)
                    && (/.*[0-9]/).test(pwd) && (/^\w{8,}$/).test(pwd) && (/^\w{0,30}$/).test(pwd)
                    && usr != '' && usr.indexOf('@') > -1 && usr.length - 1 > usr.indexOf('@'))) {
                    //event.preventDefault();
                    return false;
                }
                else if (event.keyCode == 13) {
                    document.getElementById('signup_submit').click();
                }
            });
        });
    </script>

<script>

    // function init() {

    //     /*intialize positions*/

    //     //create_account_div
    //     var create_account_div = document.getElementById('create_account_div');
    //     var create_account_div_Intensity = 0;
    //     create_account_div.style.opacity = create_account_div_Intensity;
    //     create_account_div.style.visibility = 'visible';
    //     var create_account_div_Position = -10;
    //     create_account_div.style.position = 'relative';
    //     create_account_div.style.left = create_account_div_Position + 'px';

    //     //password_requirements
    //     var password_requirements = document.getElementById('password_requirements');
    //     var password_requirements_Intensity = 0;
    //     password_requirements.style.opacity = password_requirements_Intensity;
    //     password_requirements.style.visibility = 'visible';
    //     var password_requirements_Position = -10;
    //     password_requirements.style.position = 'relative';
    //     password_requirements.style.left = password_requirements_Position + 'px';

    //     /*intervals*/

    //     //create_account_div
    //     setTimeout(run_create_account_div_IntervalFunction, 0);
    //     function run_create_account_div_IntervalFunction() {
    //         var run_create_account_div_Interval = setInterval(create_account_div_IntervalFunction, 1);
    //     }
    //     function create_account_div_IntervalFunction() {
    //         if (create_account_div_Intensity < 1) {
    //             create_account_div_Intensity += .005;
    //             create_account_div_Position += .05;
    //             create_account_div.style.opacity = create_account_div_Intensity;
    //             create_account_div.style.left = create_account_div_Position + 'px';
    //         }
    //         else {
    //             clearInterval(run_create_account_div_Interval);
    //         }
    //     }

    //     //password_requirements
    //     setTimeout(run_password_requirements_IntervalFunction, 0);
    //     function run_password_requirements_IntervalFunction() {
    //         var run_password_requirements_Interval = setInterval(password_requirements_IntervalFunction, 1);
    //     }
    //     function password_requirements_IntervalFunction() {
    //         if (password_requirements_Intensity < 1) {
    //             password_requirements_Intensity += .005;
    //             password_requirements_Position += .05;
    //             password_requirements.style.opacity = password_requirements_Intensity;
    //             password_requirements.style.left = password_requirements_Position + 'px';
    //         }
    //         else {
    //             clearInterval(run_password_requirements_Interval);
    //         }
    //     }

    // }
    // window.onload = init;

    document.getElementById('signup_submit').disabled = true;

    function update_password_requirements() {
        
        var requirement1 = document.getElementById('password_requirement_1');
        var requirement2 = document.getElementById('password_requirement_2');
        var requirement3 = document.getElementById('password_requirement_3');
        var requirement4 = document.getElementById('password_requirement_4');
        var requirement5 = document.getElementById('password_requirement_5');

        var re1 = /.*[a-z]/;
        var re2 = /.*[A-Z]/;
        var re3 = /.*[0-9]/;
        var re4 = /^\w{8,}$/;
        var re5 = /^\w{0,30}$/;

        var pwd = document.getElementById('pwd').value;

        if (re1.test(pwd)) {
            requirement1.style.color = 'green';
            requirement1.style.fontWeight = '700';
            requirement1.style.fontSize = 'medium';
            requirement1.imageStyleImage= "url('http://eddylu.com/images/checkmark.png')";
        }
        else {
            requirement1.style.color = 'black';
            requirement1.style.fontWeight = '500';
            requirement1.style.fontSize = 'initial';
        }

        if (re2.test(pwd)) {
            requirement2.style.color = 'green';
            requirement2.style.fontWeight = '700';
            requirement2.style.fontSize = 'medium';
        }
        else {
            requirement2.style.color = 'black';
            requirement2.style.fontWeight = '500';
            requirement2.style.fontSize = 'initial';
        }

        if (re3.test(pwd)) {
            requirement3.style.color = 'green';
            requirement3.style.fontWeight = '700';
            requirement3.style.fontSize = 'medium';
        }
        else {
            requirement3.style.color = 'black';
            requirement3.style.fontWeight = '500';
            requirement3.style.fontSize = 'initial';
        }

        if (re4.test(pwd)) {
            requirement4.style.color = 'green';
            requirement4.style.fontWeight = '700';
            requirement4.style.fontSize = 'medium';
        }
        else {
            requirement4.style.color = 'black';
            requirement4.style.fontWeight = '500';
            requirement4.style.fontSize = 'initial';
        }

        if (re5.test(pwd)) {
            requirement5.style.color = 'green';
            requirement5.style.fontWeight = '700';
            requirement5.style.fontSize = 'medium';
        }
        else {
            requirement5.style.color = 'black';
            requirement5.style.fontWeight = '500';
            requirement5.style.fontSize = 'initial';
        }

        var usr = document.getElementById('usr').value;
        var signup_submit = document.getElementById('signup_submit');

        if (!(re1.test(pwd) && re2.test(pwd) && re3.test(pwd) && re4.test(pwd) && re5.test(pwd)
            && usr != '' && usr.indexOf('@') > -1 && usr.length - 1 > usr.indexOf('@'))) {
            signup_submit.disabled = true;
        }
        else {
            signup_submit.disabled = false;
        }

    }

</script>

{% endblock %}